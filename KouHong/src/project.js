require=function n(r,a,s){function l(e,t){if(!a[e]){if(!r[e]){var i="function"==typeof require&&require;if(!t&&i)return i(e,!0);if(u)return u(e,!0);var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}var c=a[e]={exports:{}};r[e][0].call(c.exports,function(t){return l(r[e][1][t]||t)},c,c.exports,n,r,a,s)}return a[e].exports}for(var u="function"==typeof require&&require,t=0;t<s.length;t++)l(s[t]);return l}({bullet:[function(t,e,i){"use strict";cc._RF.push(e,"67ec7SCgQ5AiLUtfTc2ec53","bullet"),cc.Class({extends:cc.Component,properties:{},start:function(){},onCollisionEnter:function(t,e){if("CircleCenter_1"===t.node.name&&"kou_hong"===e.node.name){e.node.stopAllActions();var i=cc.bulletForFruit;e.node.parent=i;var o=cc.pRotateByAngle(i.getPosition(),cc.p(0,0),cc.degreesToRadians(180+i.rotation));o=cc.p(.85*o.x,.85*o.y),e.node.setPosition(cc.p(o)),e.node.rotation=-i.rotation,e.node.name="old_bullet";var c=cc.find("Canvas").getComponent("gameScene"),n=i.children;if(c.cutSmallBullet(),c.isPlayAudio&&cc.loader.loadRes("img/insert_audio.mp3",cc.AudioClip,function(t,e){cc.audioEngine.play(e,!1,1)}),c.shake.play(),n.length>=c.nums[c.level]){c.level++,c.isPlayAudio&&cc.loader.loadRes("img/gameSuccess_audio.mp3",cc.AudioClip,function(t,e){cc.audioEngine.play(e,!1,1)}),c.countdownTimeID&&cc.audioEngine.stop(c.countdownTimeID),t.enabled=!1;for(var r=n.length,a=0;a<r;a++){var s=c.node.convertToNodeSpace(n[0].getPosition());n[0].setPosition(cc.p(s.x,s.y+200)),n[0].rotation=0;var l=cc.jumpBy(.3,cc.p(0,200),200,1),u=Math.round(180*Math.random())-90,h=cc.rotateTo(.3,u),d=cc.moveBy(.3,cc.p(5,-1e3)),m=cc.spawn(l,h,d),p=cc.sequence(m,cc.removeSelf());n[0].runAction(p),n[0].parent=c.node}t.node.rotation=0,c.bulletParent.rotation=0,c.playAnimation(c.level)}else{var g=cc.instantiate(c.bullet);g.setPosition(cc.v2(0,0)),g.getComponent(cc.Sprite).spriteFrame=c.bulletSpriteFrames[c.level],c.bulletParent.addChild(g,2)}}else if("kou_hong"===t.node.name){t.node.stopAllActions();var v=cc.jumpBy(.2,cc.p(5,5),10,1),f=cc.moveBy(.3,cc.p(5,-500)),y=cc.callFunc(this.show),A=cc.sequence(v,f,y,cc.removeSelf());t.node.runAction(A);var S=cc.find("Canvas").getComponent("gameScene");S.isRorate=!1,S.isPlayAudio&&cc.loader.loadRes("img/collision_audio.mp3",cc.AudioClip,function(t,e){cc.audioEngine.play(e,!1,1)}),t.node.name="bullet",t.node.getComponent(cc.Animation).play("kou_hong")}},show:function(){var t=cc.find("Canvas").getComponent("gameScene");t.gameOver.active=!0,t.isTimer=!1,cc.audioEngine.stopAll()}}),cc._RF.pop()},{}],gameMenu:[function(t,e,i){"use strict";cc._RF.push(e,"8c25dmE8cBAZJ7uP6p1otht","gameMenu"),cc.Class({extends:cc.Component,properties:{},startGame:function(){cc.director.loadScene("gameScene")}}),cc._RF.pop()},{}],gameScene:[function(t,e,i){"use strict";cc._RF.push(e,"d0523Lg6nBBspwu+DfeI0ZR","gameScene"),cc.Class({extends:cc.Component,properties:{time:60,minSpeedArry:[cc.Float],maxSpeedArry:[cc.Float],rotateMinTimeArry:[cc.Float],rotateMaxTimeArry:[cc.Float],nums:[cc.Integer],playBgArry:{type:cc.Node,default:[]},kouHongArry:{type:cc.Prefab,default:null},levelArry:{type:cc.Node,default:[]},smallKouHongSprite:{type:cc.SpriteFrame,default:[]},bulletSpriteFrames:{type:cc.SpriteFrame,default:[]},leftSpriteFrames:[cc.SpriteFrame],rightSpriteFrames:[cc.SpriteFrame],kouHongParent:cc.Node,bullet:cc.Prefab,bulletParent:cc.Node,bulletForFruit:cc.Node,gameOver:cc.Node,timerLabel:cc.Label,lift:cc.Node,right:cc.Node,noVoiceCoin:cc.SpriteFrame,VoiceCoin:cc.SpriteFrame,starsAnim:cc.Animation,successNode:cc.Node,countdownTime:cc.AudioClip,bgm:cc.AudioClip,shake:cc.Animation},onLoad:function(){cc.director.getCollisionManager().enabled=!0,this.addClickEvent(),cc.bulletForFruit=this.bulletForFruit},start:function(){this.level=0,this.colors=["yellow","black","red"],this.readyStart(),this.rotateTime=0,this.rotateLR=0,this.rotateSpeed=0,this.isPlayAudio=cc.sys.localStorage.getItem("isPlayAudio"),this.isRorate=0,this.isPlayAudio?(this.isPlayAudio=JSON.parse(this.isPlayAudio),this.isPlayAudio?cc.find("voice_icon",this.node).getComponent(cc.Sprite).spriteFrame=this.VoiceCoin:cc.find("voice_icon",this.node).getComponent(cc.Sprite).spriteFrame=this.noVoiceCoin):this.isPlayAudio=!0,this.isPlayAudio?this.bgmID=cc.audioEngine.play(this.bgm,!0,1):this.bgmID=cc.audioEngine.play(this.bgm,!0,0)},audioEvent:function(t){this.isPlayAudio?(this.isPlayAudio=!1,cc.audioEngine.setVolume(this.bgmID,0),t.target.getComponent(cc.Sprite).spriteFrame=this.noVoiceCoin):(this.isPlayAudio=!0,cc.audioEngine.setVolume(this.bgmID,1),t.target.getComponent(cc.Sprite).spriteFrame=this.VoiceCoin),cc.sys.localStorage.setItem("isPlayAudio",this.isPlayAudio)},readyStart:function(){var t=this;this.unscheduleAllCallbacks(),this.validNum=0,this.timer=this.time,this.countdownTimeID=void 0;var e=this.kouHongParent.children;if(this.isTimer=!1,this.timerLabel.node.parent.active=!1,e)for(var i=e.length,o=0;o<i;o++)e[o].destroy();this.playBgArry[this.level].active=!0,this.scheduleOnce(function(){t.playBgArry[0].active=!1,t.fruit=cc.find("CircleCenter_1",t.levelArry[t.level]),t.changeLevel(t.level),t.isTimer=!0,t.isRorate=!0,t.timerLabel.node.parent.active=!0},2)},changeLevel:function(t){this.playBgArry[t].active=!1;for(var e=0;e<this.nums[t];++e){var i=cc.instantiate(this.kouHongArry);i.getChildByName("Sword_small").getComponent(cc.Sprite).spriteFrame=this.smallKouHongSprite[t],this.kouHongParent.addChild(i)}var o=cc.instantiate(this.bullet);o.setPosition(cc.v2(0,0)),o.getComponent(cc.Sprite).spriteFrame=this.bulletSpriteFrames[t],this.bulletParent.addChild(o),this.levelArry[t].active=!0},ratateFunc:function(t,e,i){this.lastFunc&&this.unschedule(this.lastFunc);var o=function(){cc.log("每帧旋转动画"),1===e?(i.rotation+=t,cc.bulletForFruit.rotation+=t):(i.rotation-=t,cc.bulletForFruit.rotation-=t)};return this.schedule(o,.1),o},restart:function(){cc.director.loadScene("gameScene")},back:function(){cc.director.loadScene("gameMenu")},onDestroy:function(){},cutSmallBullet:function(){this.kouHongParent.children[this.validNum].getChildByName("Sword_small").active=!1,this.validNum++},addClickEvent:function(){var o=this;this.node.on("touchstart",function(t){}),this.node.on("touchend",function(t){var e=o.bulletParent.children;if(0<e.length&&!(0<e[0].y)){var i=cc.moveBy(.15,cc.p(0,700));e[0].runAction(i)}})},playAnimation:function(t){this.levelArry[t-1].active=!1,this.lift.active=!0,this.right.active=!0,this.lift.getComponent(cc.Sprite).spriteFrame=this.leftSpriteFrames[t-1],this.right.getComponent(cc.Sprite).spriteFrame=this.rightSpriteFrames[t-1],this.lift.getComponent(cc.Animation).play(),this.right.getComponent(cc.Animation).play(),this.scheduleOnce(function(){this.lift.active=!1,this.right.active=!1,2<t?(this.successNode.active=!0,this.starsAnim.play(),this.isTimer=!1):(this.lift.setPosition(cc.p(-76,256)),this.right.setPosition(cc.p(81,256)),this.readyStart())},.75)},getRotateTime:function(){this.rotateTime=Math.floor(2*Math.random())+this.rotateMinTimeArry[this.level],this.startRotateTime=this.rotateTime,this.rotateSpeed=Math.round(Math.random()*this.maxSpeedArry[this.level])+this.minSpeedArry[this.level],this.rotateSpeed+=parseFloat((.1*Math.random()).toFixed(2)),this.rotateLR=.5<Math.random()?1:0},update:function(t){this.isTimer&&(this.timer-=t,this.timerLabel.string=Math.floor(this.timer),this.timer<=0?(this.unscheduleAllCallbacks(),this.gameOver.active=!0,this.isTimer=!1,cc.audioEngine.stopAll()):this.timer<=10&&(this.countdownTimeID||(this.isPlayAudio?this.countdownTimeID=cc.audioEngine.play(this.countdownTime,!0,1):this.countdownTimeID=cc.audioEngine.play(this.countdownTime,!0,0)))),this.isRorate&&(this.rotateTime<=0&&this.getRotateTime(),this.rotateTime<=.75*this.startRotateTime&&(this.rotateSpeed-=t*this.level*this.level*1.3),1===this.rotateLR?this.fruit.rotation+=this.rotateSpeed:this.fruit.rotation-=this.rotateSpeed,1===this.rotateLR?cc.bulletForFruit.rotation+=this.rotateSpeed:cc.bulletForFruit.rotation-=this.rotateSpeed,this.rotateTime-=t)}}),cc._RF.pop()},{}]},{},["bullet","gameMenu","gameScene"]);